webpackJsonp([1,4],{B7tt:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("fZjL"),a=o.n(r),s=o("Dd8w"),i=o.n(s),l=o("xAvK"),n={props:{imageMaxNum:{type:Number,default:6},imageMaxSize:{type:Number,default:2048,validator:function(e){return!(e%1024)}},showUploadList:{type:Boolean,default:!1},imageList:{type:Array,default:function(){return[]}},multiple:{type:Boolean,default:!1},action:{type:String,required:!0},uploadImage:{type:Function,default:function(){}},removeImage:{type:Function,default:function(){}},data:{type:Object,default:function(){return{}}},withCredentials:{type:Boolean,default:!1},headers:{type:Object,default:function(){return{}}}},data:function(){return{imgName:"",visible:!1,defaultList:this.imageList.map(function(e){return i()({},e)}),uploadList:[],rawImgUrl:""}},watch:{imageList:{handler:function(e,t){var o=this;e.forEach(function(e,t){e&&!e.local&&(o.uploadList[t]=i()({},e,{percentage:100,status:"finished"}))}),this.$forceUpdate()},deep:!0}},mounted:function(){this.uploadList=this.$refs.upload&&this.$refs.upload.fileList||[]},beforeDestroy:function(){this.uploadList.filter(function(e){return e.local}).forEach(function(e){window.URL.revokeObjectURL(e.url)})},methods:{handleSuccess:function(e,t){this.uploadImage()},handleRemove:function(e){var t=this.uploadList.indexOf(e);this.uploadList.splice(t,1),this.imageList.splice(t,1),this.removeImage()},handleView:function(e){this.rawImgUrl=this.uploadList.find(function(t){return t.name===e}).url,this.visible=!0},handleFormatError:function(e){this.$Notice.warning({title:"图片格式错误",desc:e.name+" 格式错误, 请选择.jpg, .jpeg, .png文件."})},handleMaxSize:function(e){var t=this.imageMaxSize<1024?"KB":"M";this.$Notice.warning({title:"图片过大",desc:e.name+" 大小不能超过"+(this.imageMaxSize/1024||this.imageMaxSize)+t})},handleBeforeUpload:function(e){var t=this.uploadList.length<this.imageMaxNum;if(!t)return this.$Notice.warning({title:"最多上传"+this.imageMaxNum+"张图片"}),t;if("javascript(void)"===this.action){if(Math.ceil(e.size/1024)>this.imageMaxSize)return this.handleMaxSize(e),!1;var o=this,r=new Image;return r.src=window.URL.createObjectURL(e),r.onload=function(){o.uploadList.push({name:e.name,percentage:100,status:"finished",url:this.src,local:!0}),o.imageList.push({name:e.name,file:e,local:!0})},!1}return!0}}},d={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"image-uploader"},[e._l(e.uploadList,function(t){return o("div",{key:t.url,staticClass:"upload-list"},["finished"===t.status?[o("img",{attrs:{src:t.avatar||t.url}}),e._v(" "),o("div",{staticClass:"upload-list-cover"},[o("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(o){e.handleView(t.name)}}}),e._v(" "),o("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(o){e.handleRemove(t)}}})],1)]:[t.showProgress?o("Progress",{attrs:{percent:t.percentage,"hide-info":""}}):e._e()]],2)}),e._v(" "),e.uploadList.length<e.imageMaxNum?o("Upload",{ref:"upload",staticClass:"upload",attrs:{"show-upload-list":e.showUploadList,"default-file-list":e.defaultList,"on-success":e.handleSuccess,format:["jpg","jpeg","png"],accept:"image/*","max-size":e.imageMaxSize,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"before-upload":e.handleBeforeUpload,multiple:e.multiple,type:"drag",action:e.action,data:e.data,"with-credentials":e.withCredentials,headers:e.headers}},[o("div",{staticClass:"upload-icon"},[o("Icon",{attrs:{type:"camera"}})],1)]):e._e(),e._v(" "),o("Modal",{attrs:{width:700,title:"查看原图"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?o("img",{staticClass:"raw-image",attrs:{src:e.rawImgUrl}}):e._e()])],2)},staticRenderFns:[]};var c={components:{"image-uploader":o("VU/8")(n,d,!1,function(e){o("wkzj")},null,null).exports},props:{modeType:{type:Number,default:0}},data:function(){return{mode:this.modeType,categoryOfGood:l.CATEGORYOFGOOD,goldTypes:l.GOLDTYPE,goldPurity:l.GOLDPURITY,brandOptions:l.BRANDOPTIONS,seriesOptions:l.SERIESOPTIONS,releaseStatus:l.RELEASESTATUS,certificates:l.CERTIFICATES,MainImageNum:l.MAINIMAGENUM,imageMaxSize:l.MAINIMAGEMAXSIZE,formGoodsBak:{},formGoods:{productid:"",category:"",model:"",title:"",goldType:"",goldPurity:"",releaseStatus:"",brand:"",series:"",certificate:"",size:"",goldContent:"",diamondWeight:"",sellingPrice:"",deposit:"",rent:"",rentcycle:0,reletcycle:0,desc:"",remark:"",createdDate:"",createdBy:"",MainImage0:[],MainImage1:[],MainImage2:[],MainImage3:[],MainImage4:[],MainImage5:[],detailImages:[]},ruleValidate:{category:[{required:!0,message:"商品类别不能为空",trigger:"blur"}],model:[{required:!0,message:"商品型号不能为空",trigger:"blur"}],title:[{required:!0,message:"商品名称不能为空",trigger:"blur"}],releaseStatus:[{required:!0,message:"发布状态不能为空",trigger:"blur"}],brand:[{required:!0,message:"品牌不能为空",trigger:"blur"}],series:[{required:!0,message:"系列不能为空",trigger:"blur"}],goldType:[{required:!0,message:"镶嵌材质不能为空",trigger:"blur"}],goldPurity:[{required:!0,message:"材质纯度不能为空",trigger:"blur"}],certificate:[{required:!0,message:"证书不能为空",trigger:"blur"}],size:[{required:!0,message:"尺寸不能为空",trigger:"blur"}],goldContent:[{required:!0,message:"含金量不能为空",trigger:"blur"},{trigger:"change",validator:function(e,t,o){var r=parseFloat(t,10);isNaN(r)&&o(new Error("输入必须为数值")),r<=0&&o(new Error("含金量不能小于0")),o()}}],diamondWeight:[{required:!0,message:"钻石重量不能为空",trigger:"blur"},{trigger:"change",validator:function(e,t,o){isNaN(+t)&&o(new Error("输入必须为数值")),parseFloat(t,10)<=0&&o(new Error("钻石重量不能小于0")),o()}}],sellingPrice:[{required:!0,message:"销售价不能为空",trigger:"blur"},{trigger:"change",validator:function(e,t,o){isNaN(+t)&&o(new Error("输入必须为数值")),parseFloat(t,10)<=0&&o(new Error("销售价不能小于0")),o()}}],deposit:[{required:!0,message:"押金不能为空",trigger:"blur"},{trigger:"change",validator:function(e,t,o){isNaN(+t)&&o(new Error("输入必须为数值")),parseFloat(t,10)<=0&&o(new Error("押金不能小于0")),o()}}],rent:[{required:!0,message:"租金不能为空",trigger:"blur"},{trigger:"change",validator:function(e,t,o){isNaN(+t)&&o(new Error("输入必须为数值")),parseFloat(t,10)<=0&&o(new Error("租金不能小于0")),o()}}],rentcycle:[{required:!0,message:"起租周期不能为空",trigger:"blur",type:"number"},{trigger:"change",validator:function(e,t,o){var r=parseFloat(t,10),a=parseInt(t,10);(isNaN(+t)||r!==a)&&o(new Error("输入必须为整数")),a<1&&o(new Error("起租周期至少1天")),o()}}],reletcycle:[{required:!0,message:"起租周期不能为空",trigger:"blur",type:"number"},{trigger:"change",validator:function(e,t,o){var r=parseFloat(t,10),a=parseInt(t,10);(isNaN(+t)||r!==a)&&o(new Error("输入必须为整数")),a<1&&o(new Error("起租周期至少1天")),o()}}],desc:[{trigger:"change",type:"string",max:500,message:"商品描述至多500字符"}],remark:[{trigger:"change",type:"string",max:500,message:"备注至多500字符"}]}}},created:function(){var e=this;if(!this.modeType){this.formGoods.productid=this.$route.params.id,this.$fetch("/product/",{params:{productid:this.formGoods.productid}}).then(function(t){var o=t.data.results;if(o&&o.length){for(var r=o[0],a=0;a<e.MainImageNum;++a)r["MainImage"+a]=r["MainImage"+a]&&[i()({},r["MainImage"+a])]||[];r.detailImages=r.detailImages&&[i()({},r.detailImages)]||[],e.formGoods=i()({},r),e.formGoodsBak=i()({},r)}else e.$Message.error({content:"未找到该商品的详细信息"})}).catch(function(t){e.$Message.error({content:t})})}},methods:{formPostdata:function(){var e=this,t=new FormData;return a()(this.formGoods).forEach(function(o){var r=e.formGoods[o];o.includes("Image")?(r&&r[0]&&r[0].file&&t.append(o,r[0].file,r[0].name),r&&!r.length&&t.append(o,"")):t.append(o,r)}),t},save:function(){var e=this;this.$refs.goodsForm.validate(function(t){if(t){e.$fetch("/productupdate/",{headers:{"Content-Type":"multipart/form-data"},data:e.formPostdata(),method:"post"}).then(function(t){for(var o=t.data,r=0;r<e.MainImageNum;++r)o["MainImage"+r]=o["MainImage"+r]&&[i()({},o["MainImage"+r])]||[];o.detailImages=o.detailImages&&[i()({},o.detailImages)]||[],e.formGoods=i()({},o),e.formGoodsBak=i()({},o),e.$Message.success({content:"保存成功"})}).catch(function(t){e.$Message.error({content:t})})}else e.$Message.error({content:"保存失败"})})},cancel:function(){this.formGoods=i()({},this.formGoodsBak),this.$Message.success({content:"重置成功"})},filterMethod:function(e,t){return t.includes(e)}}},m={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"goods-detail"}},[o("Form",{ref:"goodsForm",attrs:{model:e.formGoods,"label-width":150,rules:e.ruleValidate}},[o("section",[o("header",[e._v("基本信息")]),e._v(" "),o("div",{staticClass:"section-body"},[e.mode?e._e():o("FormItem",{attrs:{label:"商品ID",prop:"productid"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("p",[e._v(e._s(e.formGoods.productid))])])],1)],1),e._v(" "),o("FormItem",{attrs:{label:"商品型号",prop:"model"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[e.mode?o("Input",{attrs:{placeholder:"输入商品型号"},model:{value:e.formGoods.model,callback:function(t){e.$set(e.formGoods,"model",t)},expression:"formGoods.model"}}):o("p",[e._v(e._s(e.formGoods.model))])],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"商品类别",prop:"category"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Select",{model:{value:e.formGoods.category,callback:function(t){e.$set(e.formGoods,"category",t)},expression:"formGoods.category"}},e._l(e.categoryOfGood,function(t){return o("Option",{key:t.key,attrs:{value:t.key}},[e._v("\n                "+e._s(t.value)+"\n              ")])}))],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"商品名称",prop:"title"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Input",{attrs:{placeholder:"输入商品名称"},model:{value:e.formGoods.title,callback:function(t){e.$set(e.formGoods,"title",t)},expression:"formGoods.title"}})],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"是否发布",prop:"releaseStatus"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Select",{model:{value:e.formGoods.releaseStatus,callback:function(t){e.$set(e.formGoods,"releaseStatus",t)},expression:"formGoods.releaseStatus"}},e._l(e.releaseStatus,function(t){return o("Option",{key:t.key,attrs:{value:t.key}},[e._v("\n                "+e._s(t.value)+"\n              ")])}))],1)],1)],1)],1)]),e._v(" "),o("section",[o("header",[e._v("\n        品质信息\n      ")]),e._v(" "),o("div",{staticClass:"section-body"},[o("FormItem",{attrs:{label:"品牌",prop:"brand"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("AutoComplete",{attrs:{data:e.brandOptions,"filter-method":e.filterMethod,placeholder:"输入品牌名称"},model:{value:e.formGoods.brand,callback:function(t){e.$set(e.formGoods,"brand",t)},expression:"formGoods.brand"}})],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"系列",prop:"series"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("AutoComplete",{attrs:{data:e.seriesOptions,"filter-method":e.filterMethod,placeholder:"输入系列名称"},model:{value:e.formGoods.series,callback:function(t){e.$set(e.formGoods,"series",t)},expression:"formGoods.series"}})],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"证书",prop:"certificate"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Select",{model:{value:e.formGoods.certificate,callback:function(t){e.$set(e.formGoods,"certificate",t)},expression:"formGoods.certificate"}},e._l(e.certificates,function(t){return o("Option",{key:t.key,attrs:{value:t.key}},[e._v("\n                "+e._s(t.value)+"\n              ")])}))],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"镶嵌材质",prop:"goldType"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Select",{model:{value:e.formGoods.goldType,callback:function(t){e.$set(e.formGoods,"goldType",t)},expression:"formGoods.goldType"}},e._l(e.goldTypes,function(t){return o("Option",{key:t.key,attrs:{value:t.key}},[e._v("\n                "+e._s(t.value)+"\n              ")])}))],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"材质纯度",prop:"goldPurity"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Select",{model:{value:e.formGoods.goldPurity,callback:function(t){e.$set(e.formGoods,"goldPurity",t)},expression:"formGoods.goldPurity"}},e._l(e.goldPurity,function(t){return o("Option",{key:t.key,attrs:{value:t.key}},[e._v("\n                "+e._s(t.value)+"\n              ")])}))],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"尺寸",prop:"size"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Input",{attrs:{placeholder:"输入钻石重量"},model:{value:e.formGoods.size,callback:function(t){e.$set(e.formGoods,"size",t)},expression:"formGoods.size"}})],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"钻石重量",prop:"diamondWeight"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Input",{attrs:{placeholder:"输入钻石重量"},model:{value:e.formGoods.diamondWeight,callback:function(t){e.$set(e.formGoods,"diamondWeight",t)},expression:"formGoods.diamondWeight"}},[o("span",{attrs:{slot:"append"},slot:"append"},[e._v("克")])])],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"含金量",prop:"goldContent"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Input",{attrs:{placeholder:"输入含金量"},model:{value:e.formGoods.goldContent,callback:function(t){e.$set(e.formGoods,"goldContent",t)},expression:"formGoods.goldContent"}},[o("span",{attrs:{slot:"append"},slot:"append"},[e._v("克")])])],1)],1)],1)],1)]),e._v(" "),o("section",[o("header",[e._v("\n        销售信息\n      ")]),e._v(" "),o("div",{staticClass:"section-body"},[o("FormItem",{attrs:{label:"销售价",prop:"sellingPrice"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Input",{attrs:{placeholder:"输入销售价"},model:{value:e.formGoods.sellingPrice,callback:function(t){e.$set(e.formGoods,"sellingPrice",t)},expression:"formGoods.sellingPrice"}},[o("span",{attrs:{slot:"append"},slot:"append"},[e._v("元")])])],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"押金",prop:"deposit"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Input",{attrs:{placeholder:"输入押金"},model:{value:e.formGoods.deposit,callback:function(t){e.$set(e.formGoods,"deposit",t)},expression:"formGoods.deposit"}},[o("span",{attrs:{slot:"append"},slot:"append"},[e._v("元")])])],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"租金",prop:"rent"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Input",{attrs:{placeholder:"输入租金"},model:{value:e.formGoods.rent,callback:function(t){e.$set(e.formGoods,"rent",t)},expression:"formGoods.rent"}},[o("span",{attrs:{slot:"append"},slot:"append"},[e._v("元")])])],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"起租周期",prop:"rentcycle"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Input",{attrs:{placeholder:"输入起租周期"},model:{value:e.formGoods.rentcycle,callback:function(t){e.$set(e.formGoods,"rentcycle",t)},expression:"formGoods.rentcycle"}},[o("span",{attrs:{slot:"append"},slot:"append"},[e._v("天")])])],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"续租周期",prop:"reletcycle"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Input",{attrs:{placeholder:"输入续租周期"},model:{value:e.formGoods.reletcycle,callback:function(t){e.$set(e.formGoods,"reletcycle",t)},expression:"formGoods.reletcycle"}},[o("span",{attrs:{slot:"append"},slot:"append"},[e._v("天")])])],1)],1)],1)],1)]),e._v(" "),o("section",[o("header",[e._v("\n        描述信息\n      ")]),e._v(" "),o("div",{staticClass:"section-body"},[o("FormItem",{staticClass:"main-images",attrs:{label:"商品图片"}},e._l(e.MainImageNum,function(t){return o("image-uploader",{key:t-1,attrs:{"image-list":e.formGoods["MainImage"+(t-1)],"image-max-num":1,"image-max-size":e.imageMaxSize,action:"javascript(void)"}})})),e._v(" "),o("FormItem",{attrs:{label:"商品详情图片",prop:"detailImages"}},[o("image-uploader",{attrs:{"image-list":e.formGoods.detailImages,"image-max-num":1,"image-max-size":e.imageMaxSize,action:"javascript(void)"}})],1),e._v(" "),o("FormItem",{attrs:{label:"商品描述",prop:"desc"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Input",{attrs:{type:"textarea",autosize:{minRows:3},maxlength:500,placeholder:"输入商品描述信息(不超过500字符)"},model:{value:e.formGoods.desc,callback:function(t){e.$set(e.formGoods,"desc",t)},expression:"formGoods.desc"}})],1)],1)],1),e._v(" "),o("FormItem",{attrs:{label:"备注",prop:"remark"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("Input",{attrs:{type:"textarea",autosize:{minRows:3},maxlength:500,placeholder:"输入商品备注信息(不超过500字符)"},model:{value:e.formGoods.remark,callback:function(t){e.$set(e.formGoods,"remark",t)},expression:"formGoods.remark"}})],1)],1)],1),e._v(" "),e.mode?o("FormItem",[o("Button",{attrs:{type:"success"},on:{click:e.save}},[e._v("保存")]),e._v(" "),o("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:e.cancel}},[e._v("重置")])],1):e._e()],1)]),e._v(" "),e.mode?e._e():o("section",[o("header",[e._v("\n        其他信息\n      ")]),e._v(" "),o("div",{staticClass:"section-body"},[o("FormItem",{attrs:{label:"创建时间",prop:"createdDate"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("p",[e._v(e._s(e.formGoods.createdDate))])])],1)],1),e._v(" "),o("FormItem",{attrs:{label:"创建人",prop:"createdBy"}},[o("Row",[o("Col",{attrs:{xs:24,md:16,lg:12}},[o("p",[e._v(e._s(e.formGoods.createdBy))])])],1)],1),e._v(" "),o("FormItem",[o("Button",{attrs:{type:"success"},on:{click:e.save}},[e._v("保存")]),e._v(" "),o("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:e.cancel}},[e._v("重置")])],1)],1)])])],1)},staticRenderFns:[]};var u=o("VU/8")(c,m,!1,function(e){o("e+7o")},null,null);t.default=u.exports},RsTi:function(e,t){},"e+7o":function(e,t){},lVdz:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={components:{"goods-detail":o("B7tt").default},data:function(){return{}}},a={render:function(){var e=this.$createElement;return(this._self._c||e)("goods-detail",{attrs:{"mode-type":1}})},staticRenderFns:[]};var s=o("VU/8")(r,a,!1,function(e){o("RsTi")},null,null);t.default=s.exports},wkzj:function(e,t){}});
//# sourceMappingURL=1.4d64db3ce33e34fbb974.js.map