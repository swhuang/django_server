webpackJsonp([5],{C3RT:function(e,r){},t2gf:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=t("bOdI"),a=t.n(s),o=t("mvHQ"),d=t.n(o),l=t("Gu7T"),m=t.n(l),i=t("Dd8w"),n=t.n(i),c=t("xAvK"),v={data:function(){return{idTypes:c.IDTYPE,addressMaxNum:c.ADDRESSMAXNUM,memberSources:c.MEMBERSOURCE,genders:c.GENDER,saveLoading:!1,formMember:{memberId:"",name:"",gender:"",idType:"",idNo:"",birthday:"",phone:"",email:"",address:[],balance:"",deposit:"",rent:"",createdDate:"",source:""},emailModal:!1,emailModalForm:{email:""},emailValidate:{email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"邮箱格式错误",trigger:"blur"}]},addressModal:!1,addressModalForm:{address:[]}}},computed:{memberSource:function(){var e=this,r=this.memberSources.find(function(r){return r.key===e.formMember.source})||"";return r&&r.value},idType:function(){var e=this,r=this.idTypes.find(function(r){return r.key===e.formMember.idType});return r&&r.value},gender:function(){var e=this,r=this.genders.find(function(r){return r.key===e.formMember.gender});return r&&r.value}},created:function(){var e=this;this.formMember.memberId=this.$route.params.id,this.$fetch("/member/",{params:{memberId:this.formMember.memberId}}).then(function(r){var t=r.data.results;t&&t.length?(e.formMember=n()({},t[0]),e.formMember.address=JSON.parse(e.formMember.address)):e.$Message.error({content:"未找到该会员的详细信息"})}).catch(function(r){e.$Message.error({content:r})})},methods:{editField:function(e){this[e+"ModalForm"][e]="string"==typeof this.formMember[e]?this.formMember[e]:[].concat(m()(this.formMember[e])),this[e+"Modal"]=!0},saveField:function(e){var r=this;this.$refs[e+"ModalForm"].validate(function(t){if(t){r.saveLoading=!0;var s=r[e+"ModalForm"][e],o=Array.isArray(s);r.$fetch("/member/",{data:a()({memberId:r.formMember.memberId},e,o?d()(s):s),method:"post"}).then(function(t){var s=t.data;r.formMember[e]=o?JSON.parse(s[e]):s[e],r.$Message.success({content:"保存成功"}),r[e+"Modal"]=!1,r.saveLoading=!1}).catch(function(e){r.$Message.error({content:e}),r.saveLoading=!1})}else r.$Message.error({content:"保存失败"})})},cancelSaveField:function(e){this[e+"Modal"]=!1},addAddressItem:function(){this.addressModalForm.address.length===this.addressMaxNum?this.$Message.error({content:"最多添加5个常用地址"}):this.addressModalForm.address.push("")},removeAddressItem:function(e){1===this.addressModalForm.address.length?this.$Message.error({content:"至少保留1个常用地址"}):this.addressModalForm.address.splice(e,1)}}},p={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{attrs:{id:"member-detail"}},[t("Form",{attrs:{model:e.formMember,"label-width":150}},[t("section",[t("header",[e._v("基本信息")]),e._v(" "),t("div",{staticClass:"section-body"},[t("FormItem",{attrs:{label:"会员号",prop:"memberId"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(e.formMember.memberId))])])],1)],1),e._v(" "),t("FormItem",{attrs:{label:"姓名",prop:"name"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(e.formMember.name))])])],1)],1),e._v(" "),t("FormItem",{attrs:{label:"性别",prop:"gender"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(e.gender))])])],1)],1),e._v(" "),t("FormItem",{attrs:{label:"证件类型",prop:"idType"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(e.idType))])])],1)],1),e._v(" "),t("FormItem",{attrs:{label:"证件号码",prop:"idNo"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(e.formMember.idNo))])])],1)],1),e._v(" "),t("FormItem",{attrs:{label:"生日",prop:"birthday"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(e.formMember.birthday))])])],1)],1),e._v(" "),t("FormItem",{attrs:{label:"手机号",prop:"cellPhone"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(e.formMember.cellPhone))])])],1)],1),e._v(" "),t("FormItem",{attrs:{label:"邮箱",prop:"email"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(e.formMember.email))]),e._v(" "),t("Icon",{staticClass:"edit-btn",attrs:{type:"edit"},nativeOn:{click:function(r){e.editField("email")}}})],1)],1)],1)],1)]),e._v(" "),t("section",[t("header",[e._v("\n        地址管理\n        "),t("Icon",{staticClass:"edit-btn",attrs:{type:"edit"},nativeOn:{click:function(r){e.editField("address")}}})],1),e._v(" "),t("div",{staticClass:"section-body"},e._l(e.formMember.address,function(r,s){return t("FormItem",{key:s,attrs:{label:"地址"+(s+1),prop:"address"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(r))])])],1)],1)}))]),e._v(" "),t("section",[t("header",[e._v("\n        账户信息\n      ")]),e._v(" "),t("div",{staticClass:"section-body"},[t("FormItem",{attrs:{label:"余额",prop:"balance"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(e.formMember.balance+" 元"))])])],1)],1),e._v(" "),t("FormItem",{attrs:{label:"押金",prop:"deposit"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(e.formMember.deposit+" 元"))])])],1)],1),e._v(" "),t("FormItem",{attrs:{label:"租金",prop:"rent"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(e.formMember.rent+" 元"))])])],1)],1)],1)]),e._v(" "),t("section",[t("header",[e._v("\n        其他信息\n      ")]),e._v(" "),t("div",{staticClass:"section-body"},[t("FormItem",{attrs:{label:"创建时间",prop:"createdDate"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(e.formMember.createdDate))])])],1)],1),e._v(" "),t("FormItem",{attrs:{label:"创建来源",prop:"source"}},[t("Row",[t("Col",{attrs:{xs:24,md:16,lg:12}},[t("p",[e._v(e._s(e.memberSource))])])],1)],1)],1)])]),e._v(" "),t("Modal",{staticClass:"edit-field-modal",attrs:{title:"修改邮箱","mask-closable":!1},model:{value:e.emailModal,callback:function(r){e.emailModal=r},expression:"emailModal"}},[t("Form",{ref:"emailModalForm",attrs:{model:e.emailModalForm,"label-width":50,rules:e.emailValidate}},[t("FormItem",{attrs:{label:"邮箱",prop:"email"}},[t("Input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.emailModalForm.email,callback:function(r){e.$set(e.emailModalForm,"email",r)},expression:"emailModalForm.email"}})],1),e._v(" "),t("FormItem",[t("Button",{attrs:{type:"success",loading:e.saveLoading},on:{click:function(r){e.saveField("email")}}},[e._v("保存")]),e._v(" "),t("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:function(r){e.cancelSaveField("email")}}},[e._v("取消")])],1)],1)],1),e._v(" "),t("Modal",{staticClass:"edit-field-modal",attrs:{title:"修改地址",width:"700","mask-closable":!1},model:{value:e.addressModal,callback:function(r){e.addressModal=r},expression:"addressModal"}},[t("Form",{ref:"addressModalForm",attrs:{model:e.addressModalForm,"label-width":80}},[e._l(e.addressModalForm.address,function(r,s){return t("FormItem",{key:s,attrs:{label:"地址"+(s+1),prop:"address["+s+"]",rules:{required:!0,message:"地址"+(s+1)+"不能为空",trigger:"blur"}}},[t("Row",[t("Col",{attrs:{span:"18"}},[t("Input",{attrs:{type:"text",placeholder:"请填写地址信息"},model:{value:e.addressModalForm.address[s],callback:function(r){e.$set(e.addressModalForm.address,s,r)},expression:"addressModalForm.address[index]"}})],1),e._v(" "),t("Col",{attrs:{span:"4",offset:"1"}},[t("Button",{attrs:{type:"error"},on:{click:function(r){e.removeAddressItem(s)}}},[e._v("删除")])],1)],1)],1)}),e._v(" "),t("FormItem",[t("Row",[t("Col",{attrs:{span:"12"}},[t("Button",{directives:[{name:"show",rawName:"v-show",value:e.addressModalForm.address.length<e.addressMaxNum,expression:"addressModalForm.address.length < addressMaxNum"}],attrs:{type:"dashed",long:"",icon:"plus-round"},on:{click:e.addAddressItem}},[e._v("添加新地址")])],1)],1)],1),e._v(" "),t("FormItem",[t("Button",{attrs:{type:"success",loading:e.saveLoading},on:{click:function(r){e.saveField("address")}}},[e._v("保存")]),e._v(" "),t("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:function(r){e.cancelSaveField("address")}}},[e._v("取消")])],1)],2)],1)],1)},staticRenderFns:[]};var u=t("VU/8")(v,p,!1,function(e){t("C3RT")},null,null);r.default=u.exports}});
//# sourceMappingURL=5.992ab91120522e6c0cc7.js.map