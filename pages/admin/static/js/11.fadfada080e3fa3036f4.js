webpackJsonp([11],{PoqF:function(e,t){},t2gf:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("bOdI"),r=s.n(a),o=s("mvHQ"),d=s.n(o),l=s("Gu7T"),i=s.n(l),n=s("Dd8w"),m=s.n(n),c=s("xAvK"),v={data:function(){return{idTypes:c.IDTYPE,addressMaxNum:c.ADDRESSMAXNUM,memberSources:c.MEMBERSOURCE,genders:c.GENDER,saveLoading:!1,form:{memberId:"",name:"",gender:"",idType:"",idNo:"",birthday:"",phone:"",email:"",address:[],balance:"",deposit:"",rent:"",createdDate:"",source:""},emailModal:!1,emailModalForm:{email:""},emailValidate:{email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"邮箱格式错误",trigger:"blur"}]},addressModal:!1,addressModalForm:{address:[]}}},computed:{memberSource:function(){var e=this,t=this.memberSources.find(function(t){return t.key===e.form.source})||"";return t&&t.value},idType:function(){var e=this,t=this.idTypes.find(function(t){return t.key===e.form.idType});return t&&t.value},gender:function(){var e=this,t=this.genders.find(function(t){return t.key===e.form.gender});return t&&t.value}},created:function(){var e=this;this.form.memberId=this.$route.params.id,this.$fetch("/member/",{params:{memberId:this.form.memberId}}).then(function(t){var s=t.data.results;s&&s.length?(e.form=m()({},s[0]),e.form.address=JSON.parse(e.form.address)):e.$Message.error({content:"未找到该会员的详细信息"})}).catch(function(t){e.$Message.error({content:"未找到该会员的详细信息"})})},methods:{editField:function(e){this[e+"ModalForm"][e]="string"==typeof this.form[e]?this.form[e]:[].concat(i()(this.form[e])),this[e+"Modal"]=!0},saveField:function(e){var t=this;this.$refs[e+"ModalForm"].validate(function(s){if(s){t.saveLoading=!0;var a=t[e+"ModalForm"][e],o=Array.isArray(a);t.$fetch("/member/",{data:r()({memberId:t.form.memberId},e,o?d()(a):a),method:"post"}).then(function(s){var a=s.data;t.form[e]=o?JSON.parse(a[e]):a[e],t.$Message.success({content:"保存成功"}),t[e+"Modal"]=!1,t.saveLoading=!1}).catch(function(e){t.$Message.error({content:"保存失败"}),t.saveLoading=!1})}else t.$Message.error({content:"保存失败"})})},cancelSaveField:function(e){this[e+"Modal"]=!1},addAddressItem:function(){this.addressModalForm.address.length===this.addressMaxNum?this.$Message.error({content:"最多添加5个常用地址"}):this.addressModalForm.address.push("")},removeAddressItem:function(e){1===this.addressModalForm.address.length?this.$Message.error({content:"至少保留1个常用地址"}):this.addressModalForm.address.splice(e,1)}}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"member-detail"}},[s("Form",{attrs:{model:e.form,"label-width":150}},[s("section",[s("header",[e._v("基本信息")]),e._v(" "),s("div",{staticClass:"section-body"},[s("FormItem",{attrs:{label:"会员号",prop:"memberId"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(e.form.memberId))])])],1)],1),e._v(" "),s("FormItem",{attrs:{label:"姓名",prop:"name"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(e.form.name))])])],1)],1),e._v(" "),s("FormItem",{attrs:{label:"性别",prop:"gender"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(e.gender))])])],1)],1),e._v(" "),s("FormItem",{attrs:{label:"证件类型",prop:"idType"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(e.idType))])])],1)],1),e._v(" "),s("FormItem",{attrs:{label:"证件号码",prop:"idNo"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(e.form.idNo))])])],1)],1),e._v(" "),s("FormItem",{attrs:{label:"生日",prop:"birthday"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(e.form.birthday))])])],1)],1),e._v(" "),s("FormItem",{attrs:{label:"手机号",prop:"cellPhone"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(e.form.cellPhone))])])],1)],1),e._v(" "),s("FormItem",{attrs:{label:"邮箱",prop:"email"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(e.form.email))]),e._v(" "),s("Icon",{staticClass:"edit-btn",attrs:{type:"edit"},nativeOn:{click:function(t){e.editField("email")}}})],1)],1)],1)],1)]),e._v(" "),s("section",[s("header",[e._v("\n        地址管理\n        "),s("Icon",{staticClass:"edit-btn",attrs:{type:"edit"},nativeOn:{click:function(t){e.editField("address")}}})],1),e._v(" "),s("div",{staticClass:"section-body"},e._l(e.form.address,function(t,a){return s("FormItem",{key:a,attrs:{label:"地址"+(a+1),prop:"address"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(t))])])],1)],1)}))]),e._v(" "),s("section",[s("header",[e._v("\n        账户信息\n      ")]),e._v(" "),s("div",{staticClass:"section-body"},[s("FormItem",{attrs:{label:"余额",prop:"balance"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(e.form.balance+" 元"))])])],1)],1),e._v(" "),s("FormItem",{attrs:{label:"押金",prop:"deposit"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(e.form.deposit+" 元"))])])],1)],1),e._v(" "),s("FormItem",{attrs:{label:"租金",prop:"rent"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(e.form.rent+" 元"))])])],1)],1)],1)]),e._v(" "),s("section",[s("header",[e._v("\n        其他信息\n      ")]),e._v(" "),s("div",{staticClass:"section-body"},[s("FormItem",{attrs:{label:"创建时间",prop:"createdDate"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(e.form.createdDate))])])],1)],1),e._v(" "),s("FormItem",{attrs:{label:"创建来源",prop:"source"}},[s("Row",[s("Col",{attrs:{xs:24,md:16,lg:12}},[s("p",[e._v(e._s(e.memberSource))])])],1)],1)],1)])]),e._v(" "),s("Modal",{staticClass:"edit-field-modal",attrs:{title:"修改邮箱","mask-closable":!1},model:{value:e.emailModal,callback:function(t){e.emailModal=t},expression:"emailModal"}},[s("Form",{ref:"emailModalForm",attrs:{model:e.emailModalForm,"label-width":50,rules:e.emailValidate}},[s("FormItem",{attrs:{label:"邮箱",prop:"email"}},[s("Input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.emailModalForm.email,callback:function(t){e.$set(e.emailModalForm,"email",t)},expression:"emailModalForm.email"}})],1),e._v(" "),s("FormItem",[s("Button",{attrs:{type:"success",loading:e.saveLoading},on:{click:function(t){e.saveField("email")}}},[e._v("保存")]),e._v(" "),s("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:function(t){e.cancelSaveField("email")}}},[e._v("取消")])],1)],1)],1),e._v(" "),s("Modal",{staticClass:"edit-field-modal",attrs:{title:"修改地址",width:"700","mask-closable":!1},model:{value:e.addressModal,callback:function(t){e.addressModal=t},expression:"addressModal"}},[s("Form",{ref:"addressModalForm",attrs:{model:e.addressModalForm,"label-width":80}},[e._l(e.addressModalForm.address,function(t,a){return s("FormItem",{key:a,attrs:{label:"地址"+(a+1),prop:"address["+a+"]",rules:{required:!0,message:"地址"+(a+1)+"不能为空",trigger:"blur"}}},[s("Row",[s("Col",{attrs:{span:"18"}},[s("Input",{attrs:{type:"text",placeholder:"请填写地址信息"},model:{value:e.addressModalForm.address[a],callback:function(t){e.$set(e.addressModalForm.address,a,t)},expression:"addressModalForm.address[index]"}})],1),e._v(" "),s("Col",{attrs:{span:"4",offset:"1"}},[s("Button",{attrs:{type:"error"},on:{click:function(t){e.removeAddressItem(a)}}},[e._v("删除")])],1)],1)],1)}),e._v(" "),s("FormItem",[s("Row",[s("Col",{attrs:{span:"12"}},[s("Button",{directives:[{name:"show",rawName:"v-show",value:e.addressModalForm.address.length<e.addressMaxNum,expression:"addressModalForm.address.length < addressMaxNum"}],attrs:{type:"dashed",long:"",icon:"plus-round"},on:{click:e.addAddressItem}},[e._v("添加新地址")])],1)],1)],1),e._v(" "),s("FormItem",[s("Button",{attrs:{type:"success",loading:e.saveLoading},on:{click:function(t){e.saveField("address")}}},[e._v("保存")]),e._v(" "),s("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:function(t){e.cancelSaveField("address")}}},[e._v("取消")])],1)],2)],1)],1)},staticRenderFns:[]};var u=s("VU/8")(v,p,!1,function(e){s("PoqF")},null,null);t.default=u.exports}});