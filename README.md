lcz's branch copied from branch:zuling
